knitr::opts_chunk$set(echo = TRUE)
#Var =mean tot_payment per payment type
paytype_plot = drugs_interest %>% filter(received_payments == T) %>%
select(drug_name,
tot_meal_payments,
tot_nonmeal_payments,
tot_promo_payments) %>%
rename(
'Meals' = 'tot_meal_payments',
'R&D/Consult/Travel' = 'tot_nonmeal_payments',
'Promo. Lec.' = 'tot_promo_payments'
) %>%
gather(key = 'payment_kind', value = 'amount', -drug_name) %>%
group_by(payment_kind) %>%
summarise(var = mean(amount)) %>%
ggplot(data = ., aes(
x = reorder(payment_kind, -var),
y = var,
fill = payment_kind
)) +
geom_bar(stat = "identity", position = 'dodge') +
scale_fill_manual(values = c('#FAAB18' , '#1380A1', '#a13b0f')) +
bbc_style() +
scale_y_continuous(labels = dollar_format(prefix = "$")) +
labs(title = "Type of Clinician Payments Across Top 20 Drugs",
subtitle = "R&D/consult/travel and promotional lectures make up majority of payments",
caption = "Data source: 2016 Top 50 Drugs, propublica.org") +
geom_hline(yintercept = 0,
size = 1,
colour = "#333333") +
geom_label(
aes(label = format(
round(var, 0), big.mark = ",", scientific = FALSE
)),
hjust = .5,
vjust = 1,
colour = "white",
fill = NA,
label.size = NA,
family = "Helvetica",
size = 5
) +
theme(
panel.grid.major.y = element_line(color = "#cbcbcb"),
panel.grid.major.x = element_blank(),
plot.margin = margin(1, 1, 1, 1, "cm"),
legend.position = 'none',
plot.title = element_text(size = 24),
plot.subtitle = element_text(size = 16, face = "italic"),
plot.caption = element_text(size = 6, hjust = 1)
) + ylim(0, 300) +
scale_colour_manual(
labels = function(x)
paste0(" ", x, "  ")
)
knitr::opts_chunk$set(echo = TRUE)
#Clearout environment
rm(list = ls(all.names = TRUE)) #will clear all objects includes hidden objects.
gc()
#Load Packages
library(tidyverse)
library(dplyr)
library(ggplot2)
library(scales)
library(RColorBrewer)
library(broom)
library(ggalt)
#Download BBC Theme
if(!require(pacman))install.packages("pacman")
pacman::p_load('dplyr', 'tidyr', 'gapminder',
'ggplot2',  'ggalt',
'forcats', 'R.utils', 'png',
'grid', 'ggpubr', 'scales',
'bbplot')
devtools::install_github('bbc/bbplot')
setwd("/Users/jonathanharris/Desktop/NYCDSA/projects/rshiny_proj")
drug_df = read_csv("DataSets/ProPub_TopDrugs/doctor_drug_2016.csv")
knitr::opts_chunk$set(echo = TRUE)
#Clearout environment
rm(list = ls(all.names = TRUE)) #will clear all objects includes hidden objects.
gc()
#Load Packages
library(tidyverse)
library(dplyr)
library(ggplot2)
library(scales)
library(RColorBrewer)
library(broom)
library(ggalt)
library(tidyr)
#Download BBC Theme
if(!require(pacman))install.packages("pacman")
pacman::p_load('dplyr', 'tidyr', 'gapminder',
'ggplot2',  'ggalt',
'forcats', 'R.utils', 'png',
'grid', 'ggpubr', 'scales',
'bbplot')
devtools::install_github('bbc/bbplot')
setwd("/Users/jonathanharris/Desktop/NYCDSA/projects/rshiny_proj")
#Import Specialty Descriptive Summary CSV
specialty_data = read_csv('DataSets/topspecialty_descriptive.csv')
#Import Specialty Descriptive Summary CSV
specialty_data = read_csv('../DataSets/topspecialty_descriptive.csv')
#Import Specialty Descriptive Summary CSV
specialty_data = read_csv('../DataSets/topspecialty_descriptive.csv')
#Import Specialty Descriptive Summary CSV
specialty_data = read_csv('.../DataSets/topspecialty_descriptive.csv')
